(window.webpackJsonp=window.webpackJsonp||[]).push([[110],{438:function(s,t,a){"use strict";a.r(t);var n=a(4),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"一概念介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一概念介绍"}},[s._v("#")]),s._v(" 一概念介绍")]),s._v(" "),t("p",[s._v("数据库连接池是一个容器，负责分配，管理数据库连接（Connection）。 当系统初始化好后，容器被创建，容器中会申请一些连接对象，当用户来访问数据库时，从容器中获取连接对象，用户访问完之后，会将连接对象归还给容器。")]),s._v(" "),t("p",[t("strong",[s._v("作用")]),s._v("：")]),s._v(" "),t("ul",[t("li",[s._v("允许应用程序复用一个现有的数据库连接，而非重新建立一个，"),t("strong",[s._v("更加高效，因为每次重新建立连接非常消耗资源")])]),s._v(" "),t("li",[s._v("用户访问更加高效")])]),s._v(" "),t("p",[t("strong",[s._v("实现：")])]),s._v(" "),t("p",[s._v("标准接口：DataSource   javax.sql包下的（SUN公司提供该接口）")]),s._v(" "),t("p",[s._v("方法：")]),s._v(" "),t("ul",[t("li",[s._v("获取连接：getConnection()")]),s._v(" "),t("li",[s._v("归还连接：Connection.close()")])]),s._v(" "),t("blockquote",[t("p",[s._v("如果连接对象Connection是从连接池中获取的，那么调用Connection.close()方法，则不会再关闭连接了。而是归还连接")])]),s._v(" "),t("p",[s._v("接口如何实现？")]),s._v(" "),t("p",[s._v("一般我们不去实现它，有数据库厂商来实现\n1. C3P0：数据库连接池技术\n2. Druid：数据库连接池实现技术，由阿里巴巴提供的")]),s._v(" "),t("h1",{attrs:{id:"二-实现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二-实现"}},[s._v("#")]),s._v(" 二 实现")]),s._v(" "),t("h3",{attrs:{id:"_1-c3p0-数据库连接池技术"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_1-c3p0-数据库连接池技术"}},[s._v("#")]),s._v(" 1 C3P0：数据库连接池技术")]),s._v(" "),t("ul",[t("li",[s._v("步骤：\n"),t("ol",[t("li",[t("p",[s._v("导入jar包 (两个) c3p0-0.9.5.2.jar， mchange-commons-java-0.2.12.jar ，")]),s._v(" "),t("ul",[t("li",[s._v("不要忘记导入数据库驱动jar包")])])]),s._v(" "),t("li",[t("p",[s._v("定义配置文件：")]),s._v(" "),t("ul",[t("li",[s._v("名称： c3p0.properties 或者 c3p0-config.xml")]),s._v(" "),t("li",[s._v("路径：直接将文件放在src目录下即可。")])])]),s._v(" "),t("li",[t("p",[s._v("创建核心对象 数据库连接池对象 ComboPooledDataSource")])]),s._v(" "),t("li",[t("p",[s._v("获取连接： getConnection")])])])]),s._v(" "),t("li",[s._v("代码：\n//1.创建数据库连接池对象\nDataSource ds  = new ComboPooledDataSource();\n//2. 获取连接对象\nConnection conn = ds.getConnection();")])]),s._v(" "),t("h3",{attrs:{id:"_2-druid-数据库连接池实现技术-由阿里巴巴提供的"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_2-druid-数据库连接池实现技术-由阿里巴巴提供的"}},[s._v("#")]),s._v(" 2 Druid：数据库连接池实现技术，由阿里巴巴提供的")]),s._v(" "),t("div",{staticClass:"language- extra-class"},[t("pre",[t("code",[s._v('1. 步骤：\n\t1. 导入jar包 druid-1.0.9.jar\n\t2. 定义配置文件：\n\t\t* 是properties形式的\n\t\t* 可以叫任意名称，可以放在任意目录下\n\t3. 加载配置文件。Properties\n\t4. 获取数据库连接池对象：通过工厂来来获取  DruidDataSourceFactory\n\t5. 获取连接：getConnection\n* 代码：\n\t //3.加载配置文件\n    Properties pro = new Properties();\n    InputStream is = DruidDemo.class.getClassLoader().getResourceAsStream("druid.properties");\n    pro.load(is);\n    //4.获取连接池对象\n    DataSource ds = DruidDataSourceFactory.createDataSource(pro);\n    //5.获取连接\n    Connection conn = ds.getConnection();\n')])])]),t("h3",{attrs:{id:"_3-定义工具类"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_3-定义工具类"}},[s._v("#")]),s._v(" 3 定义工具类")]),s._v(" "),t("p",[s._v("定义一个类 JDBCUtils")]),s._v(" "),t("p",[s._v("提供静态代码块加载配置文件，初始化连接池对象")]),s._v(" "),t("p",[t("strong",[s._v("提供方法")]),s._v("：")]),s._v(" "),t("ul",[t("li",[t("p",[s._v("获取连接方法：通过数据库连接池")])]),s._v(" "),t("li",[t("p",[s._v("获取连接释放资源")])]),s._v(" "),t("li",[t("p",[s._v("获取连接池的方法")])])]),s._v(" "),t("h4",{attrs:{id:"_4-一个demo"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#_4-一个demo"}},[s._v("#")]),s._v(" 4 一个DEMO")]),s._v(" "),t("p",[s._v("环境与配置")]),s._v(" "),t("blockquote",[t("p",[s._v("MySQL8.032")]),s._v(" "),t("p",[s._v("druid-1.2.9")]),s._v(" "),t("p",[s._v("mysql-connector-j-8.0.32")])]),s._v(" "),t("p",[t("strong",[s._v("目录组织截图：")])]),s._v(" "),t("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230316194703064.png"}}),s._v(" "),t("p",[s._v("properties文件配置如下（src下任意位置即可）：")]),s._v(" "),t("div",{staticClass:"language-markdown line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-markdown"}},[t("code",[s._v("driverClassName=com.mysql.cj.jdbc.Driver\nurl=jdbc:mysql://127.0.0.1:3306/test\nusername=root\npassword=admin\ninitialSize=5\nmaxActive=10\nmaxWait=3000\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br")])]),t("p",[t("strong",[s._v("code:")])]),s._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("package")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("demo")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("alibaba"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("druid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pool"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataSourceClosedException")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("alibaba"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("druid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pool"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DruidDataSource")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("alibaba"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("druid"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("pool"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DruidDataSourceFactory")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("javax"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataSource")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("io"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FileInputStream")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("sql"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Connection")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("import")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token import"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[s._v("java"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("util"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")])]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")])]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("class")]),s._v(" druid "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("public")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("static")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("void")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("main")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("String")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" args"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("throws")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Exception")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//1导入jar包")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//2.定义配置文件")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//3.加载配置文件")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),s._v(" prop"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Properties")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('//System.out.println(System.getProperty("user.dir"));//可以用此行来查看从根目录到模块的路径')]),s._v("\n        prop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("load")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("new")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("FileInputStream")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"src/druid.properties"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//可以使用相对路径，如果上面那个getpath是带了模块名，则相对路径中不需要加模块名。否则需要")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//Files.newInputStream(Paths.get(fileName))新版函数，因为new File...会导致jvm内存回首问题")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//4.获取连接池对象")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DataSource")]),s._v(" dataSource "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("DruidDataSourceFactory")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("createDataSource")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("prop"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//ALT+ENTER可以快速抛出异常")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("//5.获取数据库连接")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("Connection")]),s._v(" connection "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v(" dataSource"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("getConnection")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n        "),t("span",{pre:!0,attrs:{class:"token class-name"}},[s._v("System")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),s._v("out"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(".")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("println")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("connection"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br")])])])}),[],!1,null,null,null);t.default=e.exports}}]);