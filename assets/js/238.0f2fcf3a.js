(window.webpackJsonp=window.webpackJsonp||[]).push([[238],{566:function(t,a,o){"use strict";o.r(a);var s=o(4),e=Object(s.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"data-presentation"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-presentation"}},[t._v("#")]),t._v(" Data Presentation")]),t._v(" "),a("p",[t._v("回到tuple本身，tuple在硬盘里面就是一串二进制数据。DBMS需要解释这些bytes为属性的类型和值。这是如何实现的?")]),t._v(" "),a("p",[t._v("以下是一些数据类型，其中像整数，大整数这些开源按照C++的方式去存。")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208152049905.png"}}),t._v(" "),a("h3",{attrs:{id:"浮点数的问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#浮点数的问题"}},[t._v("#")]),t._v(" 浮点数的问题")]),t._v(" "),a("p",[a("strong",[t._v("但是其中浮点数(Float,Double)不能按照C++类型来存，因为会有精度问题，所以按照IEEE-754标准来存")])]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208152403644.png",alt:"image-20231208152403644"}}),t._v(" "),a("blockquote",[a("p",[t._v("举例子：")]),t._v(" "),a("p",[t._v("在做业务时，一般严禁用浮点数来存钱。")])]),t._v(" "),a("p",[t._v("Posgres提出的NUMERIC就是为了来精确的存浮点数。")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208152512409.png",alt:"image-20231208152512409"}}),t._v(" "),a("p",[t._v("MySQL也有NUMERIC")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208152704138.png",alt:"image-20231208152704138"}}),t._v(" "),a("h3",{attrs:{id:"large-values"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#large-values"}},[t._v("#")]),t._v(" Large Values")]),t._v(" "),a("p",[t._v("这里指的不是这个值很大，而是这个数目占用的空间很大，这个数据很长，比我们的DBMS的一页还大。")]),t._v(" "),a("blockquote",[a("p",[t._v("Most DBMS don‘t allow a tuple to exceed the size of a single page    ("),a("strong",[t._v("大多数的磁盘不会允许一个元组超过单个页的大小")]),t._v(")")])]),t._v(" "),a("p",[t._v("对于这个问题，一些DBMS采用溢出页的方法来辅助存过大的tuple，并且规定了使用溢出页的情况。")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208153523933.png",alt:"image-20231208153523933"}}),t._v(" "),a("h3",{attrs:{id:"external-value-storage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#external-value-storage"}},[t._v("#")]),t._v(" External value storage")]),t._v(" "),a("p",[t._v("存外部数据的地址")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208153616068.png",alt:"image-20231208153616068"}}),t._v(" "),a("h3",{attrs:{id:"system-catalogs"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#system-catalogs"}},[t._v("#")]),t._v(" System Catalogs")]),t._v(" "),a("p",[t._v("一个DBMS会存数据库的"),a("code",[t._v("meta-data")]),t._v("在他的内部目录中")]),t._v(" "),a("ul",[a("li",[t._v("Tables,columns,indexs,views")]),t._v(" "),a("li",[t._v("Users,permissions")]),t._v(" "),a("li",[t._v("Internal statistics")])]),t._v(" "),a("p",[t._v("基本每个DBMS存数据库的Catalogs在自己里面(ie.tables),这个东西叫"),a("code",[t._v("Information_schema")]),t._v("。")]),t._v(" "),a("blockquote",[a("p",[a("strong",[t._v("其实就是数据库会将元数据信息用表存起来")]),t._v("，这些个表统称information_schema，这样做能最大限度的利用数据库本身。")])]),t._v(" "),a("img",{staticStyle:{zoom:"67%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208154924735.png",alt:"image-20231208154924735"}}),t._v(" "),a("h3",{attrs:{id:"database-workload"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#database-workload"}},[t._v("#")]),t._v(" DataBase WorkLoad")]),t._v(" "),a("blockquote",[a("p",[t._v("workload:  工作负载")])]),t._v(" "),a("p",[a("strong",[t._v("OLTP (online Transaction Procession)：在线事务处理")])]),t._v(" "),a("ul",[a("li",[t._v("Fast operation that only read/update a small amount of data each time（每次只对一小部分数据进行的快速读/更新操作）")]),t._v(" "),a("li",[t._v("一般用户用，比如我给一个朋友转账")])]),t._v(" "),a("p",[a("strong",[t._v("OLAP(On-Line Analytical Processing)：在线分析处理")])]),t._v(" "),a("ul",[a("li",[t._v("Complex queries that read a lot of data to compute aggregates（读大量数据进行聚合计算）")]),t._v(" "),a("li",[t._v("一般是公司用，比如支付宝要统计今天的交易额")])]),t._v(" "),a("p",[a("strong",[t._v("Hybrid Transaction + Analytical Processing  混合事务和分析的处理（就是混合怪，两个都要行）")])]),t._v(" "),a("p",[t._v("不同的工作负载类型擅长的操作")]),t._v(" "),a("blockquote",[a("p",[t._v("OLTP更适合写，OLAP更适合读")])]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208160018738.png",alt:"image-20231208160018738"}}),t._v(" "),a("p",[t._v("两种不同类型工作负载的交叉")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208160515047.png",alt:"image-20231208160515047"}}),t._v(" "),a("h2",{attrs:{id:"data-storage-model"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#data-storage-model"}},[t._v("#")]),t._v(" Data Storage Model")]),t._v(" "),a("p",[a("strong",[t._v("思考：")])]),t._v(" "),a("p",[t._v("关系模型（Relation model）并没有要求我们按行存数据把？那么为什么不能按列存？")]),t._v(" "),a("p",[t._v("所以我们能不能按列存，有啥好处？")]),t._v(" "),a("h3",{attrs:{id:"行存-n-ary-storage-model-nsm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#行存-n-ary-storage-model-nsm"}},[t._v("#")]),t._v(" "),a("strong",[t._v("行存，n-ary storage model(NSM)")])]),t._v(" "),a("p",[t._v("我们之前所讲的好像都是按行（行是元组）存的，这种也称为n-ary storage model")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208161028561.png",alt:"image-20231208161028561"}}),t._v(" "),a("p",[a("strong",[t._v("优点：")])]),t._v(" "),a("ul",[a("li",[t._v("按行存比较适合OLTP类型，比如我登录微博，我能看到自己的邮箱，id，名称。因为我只关心一个用户的所有信息，不要其他用户的")])]),t._v(" "),a("p",[a("strong",[t._v("缺点：")])]),t._v(" "),a("ul",[a("li",[t._v("如果我只关心某一列的数据，那么我还是得把这一行的数据都读到再取到这一个属性，浪费资源")])]),t._v(" "),a("h3",{attrs:{id:"列存-decomposition-storage-model-dsm"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#列存-decomposition-storage-model-dsm"}},[t._v("#")]),t._v(" "),a("strong",[t._v("列存，Decomposition Storage Model(DSM)")])]),t._v(" "),a("p",[t._v("举例：我现在有维基百科的数据库，我想查这个月有那些用户的邮箱后缀为.gov的人访问过。")]),t._v(" "),a("p",[t._v("这个时候我只关心某一项属性，但是由于我存的是行，其他无用的信息也都得读。")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208161230503.png",alt:"image-20231208161230503"}}),t._v(" "),a("p",[t._v("这时候我们就想到按列存储（"),a("strong",[t._v("也就是一列才是元组")]),t._v("）。")]),t._v(" "),a("p",[t._v("这样我们每次就不需要读取全部的属性，会大量减少磁盘I/O")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208161853325.png",alt:"image-20231208161853325"}}),t._v(" "),a("p",[t._v("优点：")]),t._v(" "),a("ul",[a("li",[t._v("列存更适合分析数据，主要也是分析数据一般都要同列的元素决定得")])]),t._v(" "),a("p",[t._v("缺点：")]),t._v(" "),a("ul",[a("li",[t._v("由于splitting/stiching，点查询，还有插入，删除等等更慢")])]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208162110402.png"}}),t._v(" "),a("p",[t._v("列存发展历史，很多数据库都借鉴了")]),t._v(" "),a("blockquote",[a("p",[t._v("这里注意，这些数据库并不是只有列存，大部分是又开发了一套基于列存的引擎")])]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208162310947.png",alt:"image-20231208162310947"}}),t._v(" "),a("h2",{attrs:{id:"conclusion"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#conclusion"}},[t._v("#")]),t._v(" Conclusion")]),t._v(" "),a("img",{staticStyle:{zoom:"50%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20231208162343262.png",alt:"image-20231208162343262"}})])}),[],!1,null,null,null);a.default=e.exports}}]);