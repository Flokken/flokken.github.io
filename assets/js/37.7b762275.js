(window.webpackJsonp=window.webpackJsonp||[]).push([[37],{366:function(t,a,s){"use strict";s.r(a);var m=s(4),c=Object(m.a)({},(function(){var t=this,a=t._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h2",{attrs:{id:"vector-set-as-input"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vector-set-as-input"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Vector Set as Input")])]),t._v(" "),a("p",[t._v("之前的神经网络（CNN）都是一个单独的vecotr比如图像输入到网络，然后得到类别概率啥的")]),t._v(" "),a("p",[t._v("但是现在遇到一些问题要输入很多向量")]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702093352267.png"}}),t._v(" "),a("p",[t._v("比如一段话，一个图，一段音频等等，此时网络输出也有变化，可以输出一个label，固定长label，或者由model决定长度的label")]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702100206855.png"}}),t._v(" "),a("p",[t._v("先关注 每个输入都有以一个对应输出label的类型")]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702100501681.png"}}),t._v(" "),a("p",[t._v("假设输入一段话 i saw a sae   用全连接层做，也就是每个单词输入FC中，能得到与一个输出，"),a("strong",[t._v("但是问题是，没有语义（上下文关系），比如两个saw应该输出不一样的东西（意思都不一样），但FC显然输出一样的")])]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702100821597.png"}}),t._v(" "),a("p",[t._v("我们可以改进输入，设计一个window包含上下几个单词，输入进去，就有一定上下文语义了，"),a("strong",[t._v("但是问题是如果我希望要整个sequence的输入，window就太大了")])]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702100559782.png"}}),t._v(" "),a("h2",{attrs:{id:"self-attention"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#self-attention"}},[t._v("#")]),t._v(" Self-Attention")]),t._v(" "),a("h3",{attrs:{id:"介绍"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#介绍"}},[t._v("#")]),t._v(" 介绍")]),t._v(" "),a("p",[t._v("引入self-attention这个层来解决，当然，self-attention可以交替连接使用，比如self-attention连接Fc层再连接self-attention")]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702101325822.png"}}),t._v(" "),a("p",[t._v("那么接下来关注这个层内部是如何工作的")]),t._v(" "),a("p",[t._v("假设"),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-TeXAtom",[a("mjx-mover",[a("mjx-over",{staticStyle:{"padding-bottom":"0.06em","padding-left":"0.015em","margin-bottom":"-0.516em"}},[a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"20D7"}})],1)],1),a("mjx-base",[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"a"}})],1)],1)],1)],1)],1)],1),t._v("是输入，"),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-TeXAtom",[a("mjx-mover",[a("mjx-over",{staticStyle:{"padding-bottom":"0.06em","margin-bottom":"-0.516em"}},[a("mjx-mo",{staticClass:"mjx-n"},[a("mjx-c",{attrs:{c:"20D7"}})],1)],1),a("mjx-base",{staticStyle:{"padding-left":"0.036em"}},[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"b"}})],1)],1)],1)],1)],1)],1),t._v("是输出，对于每一个"),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-msup",[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"a"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[a("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[a("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1)],1),t._v("都会去寻找这个sequence中和他相关的输入，然后综合他们，在输出"),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-msup",[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"b"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[a("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[a("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1)],1)],1),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702102401182.png"}}),t._v(" "),a("p",[t._v("**如何计算两个向量之间关联性即"),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"3B1"}})],1)],1)],1),t._v("?**现在常见用的方式是dot-product，也就是把输入的向量分别乘以不同的系数矩阵，然后把他们的乘机再乘起来")],1),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702102747888.png"}}),t._v(" "),a("p",[a("strong",[t._v("接下来，self-attention中就要去计算该向量与各个向量之间的关联性，关联性也叫做attention score")])]),t._v(" "),a("blockquote",[a("p",[a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-msup",[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"a"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[a("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[a("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1)],1),t._v("也会跟自己做关联性计算，下面图没写，这很重要")],1)]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702103059864.png"}}),t._v(" "),a("p",[t._v("最后把attention-score经过某个层，这里是soft-max（好像也可以是ReLu）层，然后就得到一排标准化输出"),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-msup",[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"3B1"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[a("mjx-mo",{staticClass:"mjx-n",attrs:{size:"s"}},[a("mjx-c",{attrs:{c:"2018"}})],1)],1)],1)],1)],1)],1),t._v(" "),a("blockquote",[a("p",[t._v("这里好像是为了标准化？")])]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702103553433.png"}}),t._v(" "),a("p",[t._v("最后，利用上面的"),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-msup",[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"3B1"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[a("mjx-mo",{staticClass:"mjx-n",attrs:{size:"s"}},[a("mjx-c",{attrs:{c:"2018"}})],1)],1)],1)],1)],1),t._v("和下面的"),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"v"}})],1)],1)],1),t._v("就能得到一个"),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-msup",[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"b"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[a("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[a("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1)],1),t._v("的输出，就是把他们的乘机全部加起来")],1),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702104002030.png"}}),t._v(" "),a("p",[t._v("总结一下，感觉就是先对输入点积算关联度，然后用关联度输入到softmax算一下（标准化），最后得到一个标准化输出，再累积输入乘以一个权重再乘刚才的标准化输出得到b")]),t._v(" "),a("blockquote",[a("p",[t._v("后面还有讲从矩阵出发去理解，也就是怎么去算，暂时略去")])]),t._v(" "),a("h3",{attrs:{id:"multi-head-self-attention"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#multi-head-self-attention"}},[t._v("#")]),t._v(" "),a("strong",[t._v("Multi-head Self-attention")])]),t._v(" "),a("p",[t._v("多头注意力机制，主要是想考虑当我们计算相关性的时候，可能有不同种类的相关性，可以让"),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-msup",[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"q"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[a("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[a("mjx-c",{attrs:{c:"1"}})],1)],1)],1)],1)],1),t._v("和"),a("mjx-container",{staticClass:"MathJax",attrs:{jax:"CHTML"}},[a("mjx-math",{staticClass:"MJX-TEX"},[a("mjx-msup",[a("mjx-mi",{staticClass:"mjx-i"},[a("mjx-c",{attrs:{c:"q"}})],1),a("mjx-script",{staticStyle:{"vertical-align":"0.363em"}},[a("mjx-mn",{staticClass:"mjx-n",attrs:{size:"s"}},[a("mjx-c",{attrs:{c:"2"}})],1)],1)],1)],1)],1),t._v("代表不同的注意力")],1),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702105439545.png"}}),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702105750394.png"}}),t._v(" "),a("p",[t._v("然后可以把他们乘一个系数矩阵得打一个b")]),t._v(" "),a("p",[a("img",{attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702105855735.png",alt:"image-20230702105855735"}})]),t._v(" "),a("h3",{attrs:{id:"positional-encoding"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#positional-encoding"}},[t._v("#")]),t._v(" Positional Encoding")]),t._v(" "),a("p",[t._v("之前的注意力机制，没有考虑到位置的影响")]),t._v(" "),a("blockquote",[a("p",[t._v("点积，也就是点对，显然是两点之间没有考虑距离的")])]),t._v(" "),a("p",[t._v("因此可以考虑人造的 position vector，也可以让模型自己去学习")]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702110033384.png"}}),t._v(" "),a("p",[t._v("这个问题还待研究")]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702110225858.png"}}),t._v(" "),a("h3",{attrs:{id:"一些应用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#一些应用"}},[t._v("#")]),t._v(" 一些应用")]),t._v(" "),a("p",[t._v("比如用在语音上，由于他的sequence太长，可以缩短每次处理的sequence，叫做Truncated Self-attention")]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702111144562.png"}}),t._v(" "),a("p",[t._v("比如用在图像上,CNN把输入看成很长的一个vector，也可以把他看成vector的集合，用self-attention来解决")]),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702111447641.png"}}),t._v(" "),a("img",{staticStyle:{zoom:"70%"},attrs:{src:"https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230702111322252.png",style:"zoom:70%"}})])}),[],!1,null,null,null);a.default=c.exports}}]);