---
title: word2vec
date: 2023-04-08 
categories: 
  - 深度学习
  - 鱼书-自然语言处理
tags: 
  - null
---

## 基于推理的方法和神经网络

用向量表示单词的研究中比较成功的方法大致可以分为两种：一种是基于计数的方法；另一种是基于推理的

方法。虽然两者在获得单词含义的方法上差别很大，**但是两者的背景都是分布式假设**。

基于计数的方法根据一个单词周围的单词的出现频数 来表示该单词。具体来说，**先生成所有单词的共现矩阵，再对这个矩 阵进行 SVD，以获得密集向量（单词的分布式表示）**。但是，基于计 数的方法在**处理大规模语料库时会出现问题**。 在现实世界中，语料库处理的单词数量非常大。比如，据说英文的词 汇量超过 100 万个。如果词汇量超过 100 万个，那么使用基于计数 的方法就需要生成一个 100 万 × 100 万的庞大矩阵，但对如此庞大的矩阵执行 SVD 显然是不现实的。



两种方法区别



<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230408223023784.png" style="zoom:70%">

基于计数的方法使用整个语料库的统计数据（共现矩阵和 PPMI 等），通过一次处理（SVD 等）获得单词的分布式表示。

基于推理 的方法使用神经网络，通常在 mini-batch 数据上进行学习。这意味着神经网络一次只需要看一部分学习数据（mini-batch），并反复更 新权重。

再详细一点：

基于计数的方法一次性处理全部学习数据；反之，基 于推理的方法使用部分学习数据逐步学习。这意味着，在词汇量很大 的语料库中，**即使 SVD 等的计算量太大导致计算机难以处理，神经网 络也可以在部分数据上学习**。

并且，神经网络的学习可以使用多台机 器、多个 GPU 并行执行，从而加速整个学习过程。在这方面，基于推 理的方法更有优势。

### 基于推理的方法

当给出周围的单词（上下文）时，预测“？”处会出现什么单词，这就是推理

![image-20230409213153919](https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230409213153919.png)

从“模型视角”出发如下：

这个模型接收上下文信息作为输入，并输出（可能出现的）各个单词的出现概率。在这样的框架中，使用语料库来学习模型，使之能做出正确的预测。另外，作为模型学习的产物，我们得到了**单词的分布式表示**

![image-20230409214009970](https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230409214009970.png)

>基于推理的方法和基于计数的方法一样，也基于分布式假设。分布式假设假设“单词含义由其周围的单词构成”。基于推理的方法将这一假设归结为了上面的预测问题。由此可见，不管是哪种方法，如何对**基于分布式假设的“单词共现”**建模都是最重要的研究主题。

### 神经网络中单词的处理方法

使用神经网络来处理单词。但是，神经网络无法 直接处理 you 或 say 这样的单词，要用神经网络处理单词，**需要先将单词转化为固定长度的向量**。对此，一种方式是将单词转换为 one-hot 表示（**one-hot 向量**）。**在 one-hot 表示中，只有一个元素是 1，其他元素都是0**

此处仍然以You say goodbye and I say hello.为例

![image-20230409214854565](https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20230409214854565.png)

<img src="" style="zoom:70%">

<img src="" style="zoom:70%">

<img src="" style="zoom:70%">

<img src="" style="zoom:70%">

<img src="" style="zoom:70%">

<img src="" style="zoom:70%">

<img src="" style="zoom:70%">

