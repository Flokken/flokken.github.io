---
title: è¡Œä¸ºå‹æ¨¡å¼
date: 2024-01-01
tags: 
  - è®¾è®¡æ¨¡å¼
categories: 
  - å…¶ä»–
  - è®¾è®¡æ¨¡å¼
---

## ç­–ç•¥æ¨¡å¼

ç­–ç•¥æ¨¡å¼æŒ‡çš„æ˜¯å®šä¹‰äº†ä¸€ç³»åˆ—ç®—æ³•ï¼Œå¹¶å°†ä»–ä»¬å°è£…èµ·æ¥ï¼Œä½¿å¾—ä»–ä»¬å¯ä»¥äº’ç›¸æ›¿æ¢ï¼Œä¸”ç®—æ³•çš„å˜åŒ–ä¸ä¼šå½±å“ä½¿ç”¨ç®—æ³•çš„å®¢æˆ·ã€‚ç­–ç•¥æ¨¡å¼å±äºå¯¹è±¡è¡Œä¸ºæ¨¡å¼ï¼Œä»–é€šè¿‡å¯¹ç®—æ³•è¿›è¡Œå°è£…ï¼ŒæŠŠä½¿ç”¨çš„ç®—æ³•çš„è´£ä»»å’Œç®—æ³•çš„å®ç°åˆ†å‰²å¼€ï¼Œå¹¶è®©ä¸åŒçš„å¯¹è±¡å¯¹è¿™äº›ç®—æ³•è¿›è¡Œç®¡ç†ã€‚

> ç­–ç•¥æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºæ¨¡å¼ï¼Œä¹Ÿæ˜¯æ›¿ä»£å¤§é‡`ifelse`çš„åˆ©å™¨ã€‚å®ƒæ‰€èƒ½å¸®ä½ è§£å†³çš„æ˜¯åœºæ™¯ï¼Œä¸€èˆ¬æ˜¯å…·æœ‰åŒç±»å¯æ›¿ä»£çš„è¡Œä¸ºé€»è¾‘ç®—æ³•åœºæ™¯ã€‚æ¯”å¦‚ï¼›ä¸åŒç±»å‹çš„äº¤æ˜“æ–¹å¼(ä¿¡ç”¨å¡ã€æ”¯ä»˜å®ã€å¾®ä¿¡)ã€ç”Ÿæˆå”¯ä¸€IDç­–ç•¥(UUIDã€DBè‡ªå¢ã€DB+Redisã€é›ªèŠ±ç®—æ³•ã€Leafç®—æ³•)ç­‰ï¼Œéƒ½å¯ä»¥ä½¿ç”¨ç­–ç•¥æ¨¡å¼è¿›è¡Œè¡Œä¸ºåŒ…è£…ï¼Œä¾›ç»™å¤–éƒ¨ä½¿ç”¨ã€‚

### åœºæ™¯æ¨¡æ‹Ÿ

**åœ¨æœ¬æ¡ˆä¾‹ä¸­æˆ‘ä»¬æ¨¡æ‹Ÿåœ¨è´­ä¹°å•†å“æ—¶å€™ä½¿ç”¨çš„å„ç§ç±»å‹ä¼˜æƒ åˆ¸(æ»¡å‡ã€ç›´å‡ã€æŠ˜æ‰£ã€nå…ƒè´­)**

<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/itstack-demo-design-20-03.png" alt="åœºæ™¯æ¨¡æ‹Ÿï¼›å•†å“æ”¯ä»˜ä½¿ç”¨è¥é”€ä¼˜æƒ åˆ¸" style="zoom:80%;" />

è¿™ä¸ªåœºæ™¯å‡ ä¹ä¹Ÿæ˜¯å¤§å®¶çš„ä¸€ä¸ªæ—¥å¸¸è´­ç‰©çœé’±æ¸ é“ï¼Œè´­ä¹°å•†å“çš„æ—¶å€™éƒ½å¸Œæœ›æ‰¾ä¸€äº›ä¼˜æƒ åˆ¸ï¼Œè®©è´­ä¹°çš„å•†å“æ›´åŠ å®æƒ ã€‚è€Œä¸”åˆ°äº†å¤§ä¿ƒçš„æ—¶å€™å°±ä¼šæœ‰æ›´å¤šçš„ä¼˜æƒ åˆ¸éœ€è¦è®¡ç®—é‚£äº›å•†å“ä¸€èµ·è´­ä¹°æ›´åŠ ä¼˜æƒ ï¼ï¼ï¼

è¿™æ ·çš„åœºæ™¯æœ‰æ—¶å€™ç”¨æˆ·ç”¨èµ·æ¥è¿˜æ˜¯è›®çˆ½çš„ï¼Œä½†æ˜¯æœ€åˆè¿™æ ·åŠŸèƒ½çš„è®¾å®šä»¥åŠäº§å“çš„ä¸æ–­è¿­ä»£ï¼Œå¯¹äºç¨‹åºå‘˜ğŸ‘¨â€ğŸ’»â€å¼€å‘è¿˜æ˜¯ä¸å¤ªå®¹æ˜“çš„ã€‚**å› ä¸ºè¿™é‡ŒåŒ…æ‹¬äº†å¾ˆå¤šçš„è§„åˆ™å’Œä¼˜æƒ é€»è¾‘ï¼Œæ‰€ä»¥æˆ‘ä»¬æ¨¡æ‹Ÿå…¶ä¸­çš„ä¸€ä¸ªè®¡ç®—ä¼˜æƒ çš„æ–¹å¼ï¼Œä½¿ç”¨ç­–ç•¥æ¨¡å¼æ¥å®ç°ã€‚**

æˆ‘ä»¬ç”¨ä¼ ç»Ÿçš„é¢å‘è¿‡ç¨‹å¼€å‘

```java
/**
 * åšå®¢ï¼šhttps://bugstack.cn - æ²‰æ·€ã€åˆ†äº«ã€æˆé•¿ï¼Œè®©è‡ªå·±å’Œä»–äººéƒ½èƒ½æœ‰æ‰€æ”¶è·ï¼
 * å…¬ä¼—å·ï¼šbugstackè™«æ´æ ˆ
 * Create by å°å‚…å“¥(fustack) @2020
 * ä¼˜æƒ åˆ¸æŠ˜æ‰£è®¡ç®—æ¥å£
 * <p>
 * ä¼˜æƒ åˆ¸ç±»å‹ï¼›
 * 1. ç›´å‡åˆ¸
 * 2. æ»¡å‡åˆ¸
 * 3. æŠ˜æ‰£åˆ¸
 * 4. nå…ƒè´­
 */
public class CouponDiscountService {

    public double discountAmount(int type, double typeContent, double skuPrice, double typeExt) {
        // 1. ç›´å‡åˆ¸
        if (1 == type) {
            return skuPrice - typeContent;
        }
        // 2. æ»¡å‡åˆ¸
        if (2 == type) {
            if (skuPrice < typeExt) return skuPrice;
            return skuPrice - typeContent;
        }
        // 3. æŠ˜æ‰£åˆ¸
        if (3 == type) {
            return skuPrice * typeContent;
        }
        // 4. nå…ƒè´­
        if (4 == type) {
            return typeContent;
        }
        return 0D;
    }

}

```

- ä»¥ä¸Šæ˜¯ä¸åŒç±»å‹çš„ä¼˜æƒ åˆ¸è®¡ç®—æŠ˜æ‰£åçš„å®é™…é‡‘é¢ã€‚
- å…¥å‚åŒ…æ‹¬ï¼›ä¼˜æƒ åˆ¸ç±»å‹ã€ä¼˜æƒ åˆ¸é‡‘é¢ã€å•†å“é‡‘é¢ï¼Œå› ä¸ºæœ‰äº›ä¼˜æƒ åˆ¸æ˜¯æ»¡å¤šå°‘å‡å°‘å¤šå°‘ï¼Œæ‰€ä»¥å¢åŠ äº†`typeExt`ç±»å‹ã€‚è¿™ä¹Ÿæ˜¯æ–¹æ³•çš„ä¸å¥½æ‰©å±•æ€§é—®é¢˜ã€‚
- æœ€åæ˜¯æ•´ä¸ªçš„æ–¹æ³•ä½“ä¸­å¯¹ä¼˜æƒ åˆ¸æŠµæ‰£é‡‘é¢çš„å®ç°ï¼Œæœ€å¼€å§‹å¯èƒ½æ˜¯ä¸€ä¸ªæœ€ç®€å•çš„ä¼˜æƒ åˆ¸ï¼Œåé¢éšç€äº§å“åŠŸèƒ½çš„å¢åŠ ï¼Œä¸æ–­çš„æ‰©å±•`if`è¯­å¥ã€‚å®é™…çš„ä»£ç å¯èƒ½è¦æ¯”è¿™ä¸ªå¤šå¾ˆå¤š

### ç­–ç•¥æ¨¡å¼é‡æ„

å·¥ç¨‹ç»“æ„

```java
itstack-demo-design-20-02
â””â”€â”€ src
    â””â”€â”€ main
        â””â”€â”€ java
            â””â”€â”€ org.itstack.demo.design
                â”œâ”€â”€ event
                â”‚    â””â”€â”€ MJCouponDiscount.java
                â”‚    â””â”€â”€ NYGCouponDiscount.java
                â”‚    â””â”€â”€ ZJCouponDiscount.java
                â”‚    â””â”€â”€ ZKCouponDiscount.java
                â”œâ”€â”€ Context.java
                â””â”€â”€ ICouponDiscount.java

```

æ•´ä½“ç»“æ„

<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20240101135830523.png" alt="image-20240101135830523" style="zoom:67%;" />

- æ•´ä½“çš„ç»“æ„æ¨¡å¼å¹¶ä¸å¤æ‚ï¼Œä¸»è¦ä½“ç°çš„ä¸åŒç±»å‹çš„ä¼˜æƒ åˆ¸åœ¨è®¡ç®—ä¼˜æƒ åˆ¸æ–¹å¼çš„ä¸åŒè®¡ç®—ç­–ç•¥ã€‚
- è¿™é‡ŒåŒ…æ‹¬ä¸€ä¸ªæ¥å£ç±»(`ICouponDiscount`)ä»¥åŠå››ç§ä¼˜æƒ åˆ¸ç±»å‹çš„å®ç°æ–¹å¼ã€‚
- æœ€åæä¾›äº†ç­–ç•¥æ¨¡å¼çš„ä¸Šä¸‹æ§åˆ¶ç±»å¤„ç†ï¼Œæ•´ä½“çš„ç­–ç•¥æœåŠ¡ã€‚

**ä¼˜æƒ åˆ¸æ¥å£**

```java
public interface ICouponDiscount<T> {

    /**
     * ä¼˜æƒ åˆ¸é‡‘é¢è®¡ç®—
     * @param couponInfo åˆ¸æŠ˜æ‰£ä¿¡æ¯ï¼›ç›´å‡ã€æ»¡å‡ã€æŠ˜æ‰£ã€Nå…ƒè´­
     * @param skuPrice   skué‡‘é¢
     * @return           ä¼˜æƒ åé‡‘é¢
     */
    BigDecimal discountAmount(T couponInfo, BigDecimal skuPrice);

}

```

- å®šä¹‰äº†ä¼˜æƒ åˆ¸æŠ˜æ‰£æ¥å£ï¼Œä¹Ÿå¢åŠ äº†æ³›å‹ç”¨äºä¸åŒç±»å‹çš„æ¥å£å¯ä»¥ä¼ é€’ä¸åŒçš„ç±»å‹å‚æ•°ã€‚
- æ¥å£ä¸­åŒ…æ‹¬å•†å“é‡‘é¢ä»¥åŠå‡ºå‚è¿”å›æœ€ç»ˆæŠ˜æ‰£åçš„é‡‘é¢ï¼Œè¿™é‡Œåœ¨å®é™…å¼€å‘ä¸­ä¼šæ¯”ç°åœ¨çš„æ¥å£å‚æ•°å¤šä¸€äº›ï¼Œä½†æ ¸å¿ƒé€»è¾‘æ˜¯è¿™äº›ã€‚

####  æ¥å£å®ç°ç±»

æ»¡å‡

```java
public class MJCouponDiscount implements ICouponDiscount<Map<String,String>>  {

    /**
     * æ»¡å‡è®¡ç®—
     * 1. åˆ¤æ–­æ»¡è¶³xå…ƒå-nå…ƒï¼Œå¦åˆ™ä¸å‡
     * 2. æœ€ä½æ”¯ä»˜é‡‘é¢1å…ƒ
     */
    public BigDecimal discountAmount(Map<String,String> couponInfo, BigDecimal skuPrice) {
        String x = couponInfo.get("x");
        String o = couponInfo.get("n");

        // å°äºå•†å“é‡‘é¢æ¡ä»¶çš„ï¼Œç›´æ¥è¿”å›å•†å“åŸä»·
        if (skuPrice.compareTo(new BigDecimal(x)) < 0) return skuPrice;
        // å‡å»ä¼˜æƒ é‡‘é¢åˆ¤æ–­
        BigDecimal discountAmount = skuPrice.subtract(new BigDecimal(o));
        if (discountAmount.compareTo(BigDecimal.ZERO) < 1) return BigDecimal.ONE;

        return discountAmount;
    }
}

```

ç›´å‡

```java
public class ZJCouponDiscount implements ICouponDiscount<Double>  {

    /**
     * ç›´å‡è®¡ç®—
     * 1. ä½¿ç”¨å•†å“ä»·æ ¼å‡å»ä¼˜æƒ ä»·æ ¼
     * 2. æœ€ä½æ”¯ä»˜é‡‘é¢1å…ƒ
     */
    public BigDecimal discountAmount(Double couponInfo, BigDecimal skuPrice) {
        BigDecimal discountAmount = skuPrice.subtract(new BigDecimal(couponInfo));
        if (discountAmount.compareTo(BigDecimal.ZERO) < 1) return BigDecimal.ONE;
        return discountAmount;
    }

}

```

æŠ˜æ‰£

```java
public class ZKCouponDiscount implements ICouponDiscount<Double> {


    /**
     * æŠ˜æ‰£è®¡ç®—
     * 1. ä½¿ç”¨å•†å“ä»·æ ¼ä¹˜ä»¥æŠ˜æ‰£æ¯”ä¾‹ï¼Œä¸ºæœ€åæ”¯ä»˜é‡‘é¢
     * 2. ä¿ç•™ä¸¤ä½å°æ•°
     * 3. æœ€ä½æ”¯ä»˜é‡‘é¢1å…ƒ
     */
    public BigDecimal discountAmount(Double couponInfo, BigDecimal skuPrice) {
        BigDecimal discountAmount = skuPrice.multiply(new BigDecimal(couponInfo)).setScale(2, BigDecimal.ROUND_HALF_UP);
        if (discountAmount.compareTo(BigDecimal.ZERO) < 1) return BigDecimal.ONE;
        return discountAmount;
    }

}

```

Nå…ƒè´­

~~~java
public class NYGCouponDiscount implements ICouponDiscount<Double> {

    /**
     * nå…ƒè´­è´­ä¹°
     * 1. æ— è®ºåŸä»·å¤šå°‘é’±éƒ½å›ºå®šé‡‘é¢è´­ä¹°
     */
    public BigDecimal discountAmount(Double couponInfo, BigDecimal skuPrice) {
        return new BigDecimal(couponInfo);
    }

}

~~~

#### ç­–ç•¥æ§åˆ¶ç±»

```java
public class Context<T> {

    private ICouponDiscount<T> couponDiscount;

    public Context(ICouponDiscount<T> couponDiscount) {
        this.couponDiscount = couponDiscount;
    }

    public BigDecimal discountAmount(T couponInfo, BigDecimal skuPrice) {
        return couponDiscount.discountAmount(couponInfo, skuPrice);
    }

}

```

- ç­–ç•¥æ¨¡å¼çš„æ§åˆ¶ç±»ä¸»è¦æ˜¯å¤–éƒ¨å¯ä»¥ä¼ é€’ä¸åŒçš„ç­–ç•¥å®ç°ï¼Œåœ¨é€šè¿‡ç»Ÿä¸€çš„æ–¹æ³•æ‰§è¡Œä¼˜æƒ ç­–ç•¥è®¡ç®—ã€‚
- å¦å¤–è¿™é‡Œä¹Ÿå¯ä»¥åŒ…è£…æˆmapç»“æ„ï¼Œè®©å¤–éƒ¨åªéœ€è¦å¯¹åº”çš„æ³›å‹ç±»å‹å³å¯ä½¿ç”¨ç›¸åº”çš„æœåŠ¡ã€‚

###  æµ‹è¯•

è¿™é‡Œä»¥æ»¡å‡ä¼˜æƒ ä¸ºä¾‹

```java
@Test
public void test_mj() {
    // æ»¡100å‡10ï¼Œå•†å“100å…ƒ
    Context<Map<String,String>> context = new Context<Map<String,String>>(new MJCouponDiscount());
    //è¦é‡‡ç”¨å“ªä¸ªç®—æ³•ï¼Œå°±ç”¨å“ªä¸ªç®—æ³•çš„å®ç°ç±»å»å®ä¾‹åŒ–è¿™ä¸ªæ¥å£ï¼Œè¿™é‡Œå…¶å®ä¹Ÿæ˜¯ç”±äºæ³›å‹å’Œæ¥å£çš„æ”¯æ’‘ï¼Œæ‰èƒ½æœ‰è¿™äº›è®¾è®¡æ¨¡å¼
    Map<String,String> mapReq = new HashMap<String, String>();
    mapReq.put("x","100");
    mapReq.put("n","10");
    BigDecimal discountAmount = context.discountAmount(mapReq, new BigDecimal(100));
    logger.info("æµ‹è¯•ç»“æœï¼šæ»¡å‡ä¼˜æƒ åé‡‘é¢ {}", discountAmount);
}

//output

15:43:42.695 [main] INFO  org.itstack.demo.design.test.ApiTest - æµ‹è¯•ç»“æœï¼šæ»¡å‡ä¼˜æƒ åé‡‘é¢ 90

Process finished with exit code 0

```

æ€»ç»“ï¼š

- ä»¥ä¸Šçš„ç­–ç•¥æ¨¡å¼æ¡ˆä¾‹ç›¸å¯¹æ¥è¯´ä¸å¹¶ä¸å¤æ‚ï¼Œä¸»è¦çš„é€»è¾‘éƒ½æ˜¯ä½“ç°åœ¨å…³äºä¸åŒç§ç±»ä¼˜æƒ åˆ¸çš„è®¡ç®—æŠ˜æ‰£ç­–ç•¥ä¸Šã€‚ç»“æ„ç›¸å¯¹æ¥è¯´ä¹Ÿæ¯”è¾ƒç®€å•ï¼Œåœ¨å®é™…çš„å¼€å‘ä¸­è¿™æ ·çš„è®¾è®¡æ¨¡å¼ä¹Ÿæ˜¯éå¸¸å¸¸ç”¨çš„ã€‚å¦å¤–è¿™æ ·çš„è®¾è®¡ä¸å‘½ä»¤æ¨¡å¼ã€é€‚é…å™¨æ¨¡å¼ç»“æ„ç›¸ä¼¼ï¼Œä½†æ˜¯æ€è·¯æ˜¯æœ‰å·®å¼‚çš„ã€‚
- é€šè¿‡ç­–ç•¥è®¾è®¡æ¨¡å¼çš„ä½¿ç”¨å¯ä»¥æŠŠæˆ‘ä»¬æ–¹æ³•ä¸­çš„ifè¯­å¥ä¼˜åŒ–æ‰ï¼Œå¤§é‡çš„ifè¯­å¥ä½¿ç”¨ä¼šè®©ä»£ç éš¾ä»¥æ‰©å±•ï¼Œä¹Ÿä¸å¥½ç»´æŠ¤ï¼ŒåŒæ—¶åœ¨åæœŸé‡åˆ°å„ç§é—®é¢˜ä¹Ÿå¾ˆéš¾ç»´æŠ¤ã€‚åœ¨ä½¿ç”¨è¿™æ ·çš„è®¾è®¡æ¨¡å¼åå¯ä»¥å¾ˆå¥½çš„æ»¡è¶³éš”ç¦»æ€§ä¸å’Œæ‰©å±•æ€§ï¼Œå¯¹äºä¸æ–­æ–°å¢çš„éœ€æ±‚ä¹Ÿéå¸¸æ–¹ä¾¿æ‰¿æ¥ã€‚
- `ç­–ç•¥æ¨¡å¼`ã€`é€‚é…å™¨æ¨¡å¼`ã€`ç»„åˆæ¨¡å¼`ç­‰ï¼Œåœ¨ä¸€äº›ç»“æ„ä¸Šæ˜¯æ¯”è¾ƒç›¸ä¼¼çš„ï¼Œä½†æ˜¯æ¯ä¸€ä¸ªæ¨¡å¼æ˜¯æœ‰è‡ªå·±çš„é€»è¾‘ç‰¹ç‚¹ï¼Œåœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­æœ€ä½³çš„æ–¹å¼æ˜¯ç»è¿‡è¾ƒå¤šçš„å®è·µæ¥å¸å–ç»éªŒï¼Œä¸ºåç»­çš„ç ”å‘è®¾è®¡æä¾›æ›´å¥½çš„æŠ€æœ¯è¾“å‡ºã€‚

## æ¨¡æ¿æ¨¡å¼

æ¨¡æ¿æ¨¡å¼æŒ‡çš„æ˜¯å®šä¹‰ä¸€ä¸ªæ“ä½œçš„ç®—æ³•éª¨æ¶ï¼Œç„¶åå­ç±»ä¸­å¯ä»¥å®ç°è¿™äº›ç®—æ³•çš„æ­¥éª¤ï¼ˆæ¯”å¦‚å®ç°æŸä¸ªæ–¹æ³•ï¼‰ï¼Œä½¿å¾—å­ç±»å¯ä»¥åœ¨ä¸æ”¹å˜ç®—æ³•éª¨æ¶çš„å‰æä¸‹ï¼Œè‡ªå®šä¹‰æŸäº›æ­¥éª¤ï¼Œæ˜¯ä¸€ç§è¡Œä¸ºå‹æ¨¡å¼ã€‚

### åœºæ™¯

è¿™é‡Œä¸¾ä¸€ä¸ªå¾ˆç»å…¸çš„åœºæ™¯ï¼Œçˆ¬è™«ã€‚

> çˆ¬è™«çš„å†™æ³•ä¸€èˆ¬éƒ½æ˜¯ï¼Œloginç™»å½•ç½‘ç«™ï¼Œç„¶åè·å–ä¿¡æ¯ï¼Œç„¶åparseè§£æä¿¡æ¯ã€‚ä¹Ÿå°±æ˜¯ç®—æ³•æ˜¯å›ºå®šçš„ï¼Œä½†æ˜¯æ¯ä¸ªç½‘ç«™çš„è§£ææ–¹å¼ï¼Œç™»å½•æ–¹å¼å´ä¸ä¸€æ ·ã€‚

**åœ¨æœ¬æ¡ˆä¾‹ä¸­æˆ‘ä»¬æ¨¡æ‹Ÿçˆ¬è™«å„ç±»ç”µå•†å•†å“ï¼Œç”Ÿæˆè¥é”€æ¨å¹¿æµ·æŠ¥åœºæ™¯**

å…³äºæ¨¡ç‰ˆæ¨¡å¼çš„æ ¸å¿ƒç‚¹åœ¨äºç”±æŠ½è±¡ç±»å®šä¹‰æŠ½è±¡æ–¹æ³•æ‰§è¡Œç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯è¯´çˆ¶ç±»è§„å®šäº†å¥½ä¸€ç³»åˆ—çš„æ‰§è¡Œæ ‡å‡†ï¼Œè¿™äº›æ ‡å‡†çš„ä¸²è”æˆä¸€æ•´å¥—ä¸šåŠ¡æµç¨‹ã€‚

> å…¶å®å°±æ˜¯æŠ½è±¡ç±»ä¸­å®šä¹‰æ–¹å¼æ‰§è¡Œé¡ºåºï¼Œç„¶åå­ç±»åœ¨å®ç°è¿™äº›æŠ½è±¡æ–¹æ³•å³å¯ã€‚

#### å®ç°

~~~java
itstack-demo-design-21-00
â””â”€â”€ src
    â”œâ”€â”€ main
    â”‚   â””â”€â”€ java
    â”‚       â””â”€â”€ org.itstack.demo.design
    â”‚           â”œâ”€â”€ group
    â”‚           â”‚	  â”œâ”€â”€ DangDangNetMall.java
    â”‚           â”‚	  â”œâ”€â”€ JDNetMall.java
    â”‚           â”‚	  â””â”€â”€ TaoBaoNetMall.java
    â”‚           â”œâ”€â”€  HttpClient.java
    â”‚           â””â”€â”€  NetMall.java
    â””â”€â”€ test
        â””â”€â”€ java
            â””â”€â”€ org.itstack.demo.design.test
                â””â”€â”€ ApiTest.java

~~~

å…¶ä¸­NetMailæ˜¯æŠ½è±¡ç±»ï¼Œä»£è¡¨ç½‘ç«™ã€‚

<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20240101210210565.png" alt="image-20240101210210565" style="zoom:67%;" />

**ä¸€ä¸ªå®šä¹‰äº†æŠ½è±¡æ–¹æ³•æ‰§è¡Œé¡ºåºçš„æ ¸å¿ƒæŠ½è±¡ç±»ï¼Œä»¥åŠä¸‰ä¸ªæ¨¡æ‹Ÿå…·ä½“çš„å®ç°(`äº¬ä¸œ`ã€`æ·˜å®`ã€`å½“å½“`)çš„ç”µå•†æœåŠ¡ã€‚**

NetMailå®ç°

~~~java
/**
 * åŸºç¡€ç”µå•†æ¨å¹¿æœåŠ¡
 * 1. ç”Ÿæˆæœ€ä¼˜ä»·å•†å“æµ·æŠ¥
 * 2. æµ·æŠ¥å«å¸¦æ¨å¹¿é‚€è¯·ç 
 */
public abstract class NetMall {

    protected Logger logger = LoggerFactory.getLogger(NetMall.class);

    String uId;   // ç”¨æˆ·ID
    String uPwd;  // ç”¨æˆ·å¯†ç 

    public NetMall(String uId, String uPwd) {
        this.uId = uId;
        this.uPwd = uPwd;
    }

    /**
     * ç”Ÿæˆå•†å“æ¨å¹¿æµ·æŠ¥
     *
     * @param skuUrl å•†å“åœ°å€(äº¬ä¸œã€æ·˜å®ã€å½“å½“)
     * @return æµ·æŠ¥å›¾ç‰‡base64ä½ä¿¡æ¯
     */
    public String generateGoodsPoster(String skuUrl) {
        if (!login(uId, uPwd)) return null;             // 1. éªŒè¯ç™»å½•
        Map<String, String> reptile = reptile(skuUrl);  // 2. çˆ¬è™«å•†å“
        return createBase64(reptile);                   // 3. ç»„è£…æµ·æŠ¥
    }

    // æ¨¡æ‹Ÿç™»å½•
    protected abstract Boolean login(String uId, String uPwd);

    // çˆ¬è™«æå–å•†å“ä¿¡æ¯(ç™»å½•åçš„ä¼˜æƒ ä»·æ ¼)
    protected abstract Map<String, String> reptile(String skuUrl);

    // ç”Ÿæˆå•†å“æµ·æŠ¥ä¿¡æ¯
    protected abstract String createBase64(Map<String, String> goodsInfo);

}

~~~

ä¸‹é¢å¯¹äºä¸åŒç½‘ç«™ï¼Œå°±åªéœ€è¦å®ç°è¿™é‡Œé¢çš„æ–¹æ³•å³å¯ã€‚

ä»¥äº¬ä¸œä¸ºä¾‹

~~~java
public class JDNetMall extends NetMall {

    public JDNetMall(String uId, String uPwd) {
        super(uId, uPwd);
    }

    public Boolean login(String uId, String uPwd) {
        logger.info("æ¨¡æ‹Ÿäº¬ä¸œç”¨æˆ·ç™»å½• uIdï¼š{} uPwdï¼š{}", uId, uPwd);
        return true;
    }

    public Map<String, String> reptile(String skuUrl) {
        String str = HttpClient.doGet(skuUrl);
        Pattern p9 = Pattern.compile("(?<=title\\>).*(?=</title)");
        Matcher m9 = p9.matcher(str);
        Map<String, String> map = new ConcurrentHashMap<String, String>();
        if (m9.find()) {
            map.put("name", m9.group());
        }
        map.put("price", "5999.00");
        logger.info("æ¨¡æ‹Ÿäº¬ä¸œå•†å“çˆ¬è™«è§£æï¼š{} | {} å…ƒ {}", map.get("name"), map.get("price"), skuUrl);
        return map;
    }

    public String createBase64(Map<String, String> goodsInfo) {
        BASE64Encoder encoder = new BASE64Encoder();
        logger.info("æ¨¡æ‹Ÿç”Ÿæˆäº¬ä¸œå•†å“base64æµ·æŠ¥");
        return encoder.encode(JSON.toJSONString(goodsInfo).getBytes());
    }

}

~~~

**æ€»ç»“**

- é€šè¿‡ä¸Šé¢çš„å®ç°å¯ä»¥çœ‹åˆ°`æ¨¡ç‰ˆæ¨¡å¼`åœ¨å®šä¹‰ç»Ÿä¸€ç»“æ„ä¹Ÿå°±æ˜¯æ‰§è¡Œæ ‡å‡†ä¸Šéå¸¸æ–¹ä¾¿ï¼Œä¹Ÿå°±å¾ˆå¥½çš„æ§åˆ¶äº†åç»­çš„å®ç°è€…ä¸ç”¨å…³å¿ƒè°ƒç”¨é€»è¾‘ï¼ŒæŒ‰ç…§ç»Ÿä¸€æ–¹å¼æ‰§è¡Œã€‚é‚£ä¹ˆç±»çš„ç»§æ‰¿è€…åªéœ€è¦å…³å¿ƒå…·ä½“çš„ä¸šåŠ¡é€»è¾‘å®ç°å³å¯ã€‚
- å¦å¤–æ¨¡ç‰ˆæ¨¡å¼ä¹Ÿæ˜¯ä¸ºäº†è§£å†³å­ç±»é€šç”¨æ–¹æ³•ï¼Œæ”¾åˆ°çˆ¶ç±»ä¸­è®¾è®¡çš„ä¼˜åŒ–ã€‚è®©æ¯ä¸€ä¸ªå­ç±»åªåšå­ç±»éœ€è¦å®Œæˆçš„å†…å®¹ï¼Œè€Œä¸éœ€è¦å…³å¿ƒå…¶ä»–é€»è¾‘ã€‚è¿™æ ·æå–å…¬ç”¨ä»£ç ï¼Œè¡Œä¸ºç”±çˆ¶ç±»ç®¡ç†ï¼Œæ‰©å±•å¯å˜éƒ¨åˆ†ï¼Œä¹Ÿå°±éå¸¸æœ‰åˆ©äºå¼€å‘æ‹“å±•å’Œè¿­ä»£ã€‚

## è´£ä»»é“¾æ¨¡å¼

> [å¾®ä¿¡æ–‡ç« ](https://mp.weixin.qq.com/s?__biz=MzU0OTE4MzYzMw==&mid=2247542857&idx=2&sn=a4ffa1841e5bede09acd20bab44f4d73&chksm=fbb1a1b7ccc628a1308a7a1f9984c0cf659cf5aa7f34d654f6044588ceeed4b0f80848a4895b&scene=27&poc_token=HAYYlGWj4CXtsjhPfoOsL_Iis4ysQUUipT1NbvkN)
>
> [å®æˆ˜è®¾è®¡æ¨¡å¼](https://bugstack.cn/md/develop/design-pattern/2020-06-18-%E9%87%8D%E5%AD%A6%20Java%20%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F%E3%80%8A%E5%AE%9E%E6%88%98%E8%B4%A3%E4%BB%BB%E9%93%BE%E6%A8%A1%E5%BC%8F%E3%80%8B.html)

è´£ä»»é“¾æ¨¡å¼æ˜¯ä¸€ç§è¡Œä¸ºè®¾è®¡æ¨¡å¼ï¼Œ å…è®¸ä½ å°†è¯·æ±‚æ²¿ç€å¤„ç†è€…é“¾è¿›è¡Œå‘é€ã€‚æ”¶åˆ°è¯·æ±‚åï¼Œ æ¯ä¸ªå¤„ç†è€…å‡å¯å¯¹è¯·æ±‚è¿›è¡Œå¤„ç†ï¼Œ æˆ–å°†å…¶ä¼ é€’ç»™é“¾ä¸Šçš„ä¸‹ä¸ªå¤„ç†è€…ã€‚

è´£ä»»é“¾æ¨¡å¼çš„æ ¸å¿ƒæ˜¯è§£å†³ä¸€ç»„æœåŠ¡ä¸­çš„å…ˆåæ‰§è¡Œå¤„ç†å…³ç³»ï¼Œå°±æœ‰ç‚¹åƒä½ æ²¡é’±èŠ±äº†ï¼Œéœ€è¦å®¶åº­è´¢åŠ¡æ”¯å‡ºå®¡æ‰¹ï¼Œ10å—é’±ä»¥ä¸‹æ‰¾é—ºå¥³å®¡æ‰¹ï¼Œ100å—é’±å…ˆé—ºå¥³å®¡æ‰¹åœ¨åª³å¦‡å®¡æ‰¹ã€‚ä½ å¯ä»¥ç†è§£æƒ³è±¡æˆå½“ä½ è¦è·³æ§½çš„æ—¶å€™è¢«å®‰æ’çš„æ˜æ˜ç™½ç™½çš„è¢«å„ä¸ªé¢†å¯¼ç­¾å­—æ”¾è¡Œã€‚

<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20240102220630593.png" alt="image-20240102220630593" style="zoom:67%;" />

è´£ä»»é“¾æ¨¡å¼ä¸­æœ‰ä¸¤ç§ç±»å‹è§’è‰²ï¼š

- **æŠ½è±¡å¤„ç†è§’è‰²ï¼ˆHandlerï¼‰**ï¼šå®šä¹‰ä¸€ä¸ªå¤„ç†è¯·æ±‚çš„æ¥å£ï¼ŒåŒ…å«æŠ½è±¡å¤„ç†æ–¹æ³•å’Œä¸€ä¸ªåç»§è¿æ¥ã€‚
- **å…·ä½“å¤„ç†è€…è§’è‰²ï¼ˆConcreteHandlerï¼‰**ï¼šå®ç°æŠ½è±¡å¤„ç†è€…çš„å¤„ç†æ–¹æ³•ï¼Œè¯¥å¤„ç†æ–¹æ³•ä¸­ä¼šè¿›è¡Œåˆ¤æ–­èƒ½å¤Ÿå¤„ç†æœ¬æ¬¡è¯·æ±‚ï¼Œå¦‚æœå¯ä»¥åˆ™å°†è¯·æ±‚è½¬ç»™å…¶åç»§è€…ç»§ç»­æ‰§è¡Œå¤„ç†æ–¹æ³•ã€‚

**å¸¸è§åœºæ™¯ï¼š**

è´£ä»»é“¾çš„ä½¿ç”¨åœºæ™¯è¿˜æ˜¯æ¯”è¾ƒå¤šçš„ï¼š

- å¤šæ¡ä»¶æµç¨‹åˆ¤æ–­ï¼šæƒé™æ§åˆ¶
- ERP ç³»ç»Ÿæµç¨‹å®¡æ‰¹ï¼šæ€»ç»ç†ã€äººäº‹ç»ç†ã€é¡¹ç›®ç»ç†
- Java è¿‡æ»¤å™¨çš„åº•å±‚å®ç° Filter

### åœºæ™¯æ¨¡æ‹Ÿ

<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20240102220745448.png" alt="image-20240102220745448" style="zoom:67%;" />

**åœ¨æœ¬æ¡ˆä¾‹ä¸­æˆ‘ä»¬æ¨¡æ‹Ÿåœ¨618å¤§ä¿ƒæœŸé—´çš„ä¸šåŠ¡ç³»ç»Ÿä¸Šçº¿å®¡æ‰¹æµç¨‹åœºæ™¯**

åƒæ˜¯è¿™äº›ä¸€çº¿ç”µå•†ç±»çš„äº’è”ç½‘å…¬å¸ï¼Œé˜¿é‡Œã€äº¬ä¸œã€æ‹¼å¤šå¤šç­‰ï¼Œåœ¨618æœŸé—´éƒ½ä¼šåšä¸€äº›è¿è¥æ´»åŠ¨åœºæ™¯ä»¥åŠæä¾›çš„æ‰©å®¹å¤‡æˆ˜ï¼Œå°±åƒè¿‡å¹´æœŸé—´ç™¾åº¦çš„çº¢åŒ…ä¸€æ ·ã€‚ä½†æ˜¯æ‰€æœ‰å¼€å‘çš„è¿™äº›ç³»ç»Ÿéƒ½éœ€è¦é™†ç»­çš„ä¸Šçº¿ï¼Œå› ä¸ºä¸´è¿‘618æœ‰æ—¶å€™ä¹Ÿæœ‰ä¸€äº›ç´§æ€¥çš„è°ƒæ•´çš„éœ€è¦ä¸Šçº¿ï¼Œä½†ä¸ºäº†ä¿éšœçº¿ä¸Šç³»ç»Ÿçš„ç¨³å®šæ€§æ˜¯å°½å¯èƒ½çš„å‡å°‘ä¸Šçº¿çš„ï¼Œä¹Ÿä¼šç›¸åº”çš„å¢å¼ºå®¡æ‰¹åŠ›åº¦ã€‚å°±åƒä¸€çº§å“åº”ã€äºŒçº§å“åº”ä¸€æ ·ã€‚

**æ¥ä¸‹æ¥ç”¨è´£ä»»é“¾æ¨¡å¼æ¥å†™ä»£ç **

è´£ä»»é“¾æ¨¡å¼å¯ä»¥è®©å„ä¸ªæœåŠ¡æ¨¡å—æ›´åŠ æ¸…æ™°ï¼Œè€Œæ¯ä¸€ä¸ªæ¨¡å—é—´å¯ä»¥é€šè¿‡`next`çš„æ–¹å¼è¿›è¡Œè·å–ã€‚è€Œæ¯ä¸€ä¸ª`next`æ˜¯ç”±ç»§æ‰¿çš„ç»Ÿä¸€æŠ½è±¡ç±»å®ç°çš„ã€‚æœ€ç»ˆæ‰€æœ‰ç±»çš„èŒè´£å¯ä»¥åŠ¨æ€çš„è¿›è¡Œç¼–æ’ä½¿ç”¨ï¼Œç¼–æ’çš„è¿‡ç¨‹å¯ä»¥åšæˆå¯é…ç½®åŒ–ã€‚

 **å·¥ç¨‹ç»“æ„**

~~~xml
itstack-demo-design-13-02
â””â”€â”€ src
    â””â”€â”€ main
        â””â”€â”€ java
            â””â”€â”€ org.itstack.demo.design
                â”œâ”€â”€ impl
                â”‚    â”œâ”€â”€ Level1AuthLink.java
                â”‚    â”œâ”€â”€ Level2AuthLink.java
                â”‚    â””â”€â”€ Level3AuthLink.java
                â”œâ”€â”€ AuthInfo.java
                â””â”€â”€ AuthLink.java

~~~

**è´£ä»»é“¾ç±»å›¾**

<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/itstack-demo-design-13-03-01.png" alt="è´£ä»»é“¾ç±»å›¾" style="zoom:50%;" />

**è´£ä»»é“¾æ¨¡å¼æ¨¡å‹ç»“æ„**

<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/itstack-demo-design-13-03.png" alt="è´£ä»»é“¾æ¨¡å¼æ¨¡å‹ç»“æ„" style="zoom:50%;" />

- ä¸Šå›¾æ˜¯è¿™ä¸ªä¸šåŠ¡æ¨¡å‹ä¸­è´£ä»»é“¾ç»“æ„çš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œé€šè¿‡ä¸‰ä¸ªå®ç°äº†ç»Ÿä¸€æŠ½è±¡ç±»`AuthLink`çš„ä¸åŒè§„åˆ™ï¼Œå†è¿›è¡Œè´£ä»»ç¼–æ’æ¨¡æ‹Ÿå‡ºä¸€æ¡é“¾è·¯ã€‚è¿™ä¸ªé“¾è·¯å°±æ˜¯ä¸šåŠ¡ä¸­çš„è´£ä»»é“¾ã€‚
- ä¸€èˆ¬åœ¨ä½¿ç”¨è´£ä»»é“¾æ—¶å€™å¦‚æœæ˜¯åœºæ™¯æ¯”è¾ƒå›ºå®šï¼Œå¯ä»¥é€šè¿‡å†™æ­»åˆ°ä»£ç ä¸­è¿›è¡Œåˆå§‹åŒ–ã€‚ä½†å¦‚æœä¸šåŠ¡åœºæ™¯ç»å¸¸å˜åŒ–å¯ä»¥åšæˆxmlé…ç½®çš„æ–¹å¼è¿›è¡Œå¤„ç†ï¼Œä¹Ÿå¯ä»¥è½åˆ°åº“é‡Œè¿›è¡Œåˆå§‹åŒ–æ“ä½œã€‚

#### ä»£ç å®ç°

**è´£ä»»é“¾ä¸­è¿”å›å¯¹è±¡å®šä¹‰**

~~~java
public class AuthInfo {

    private String code;
    private String info = "";

    public AuthInfo(String code, String ...infos) {
        this.code = code;
        for (String str:infos){
            this.info = this.info.concat(str);
        }
    }
    
    // ...get/set
}

~~~

- è¿™ä¸ªç±»çš„æ˜¯åŒ…è£…äº†è´£ä»»é“¾å¤„ç†è¿‡ç¨‹ä¸­è¿”å›ç»“æœçš„ç±»ï¼Œæ–¹é¢å¤„ç†æ¯ä¸ªè´£ä»»é“¾çš„è¿”å›ä¿¡æ¯ã€‚

 **é“¾è·¯æŠ½è±¡ç±»**

~~~java
public abstract class AuthLink {

    protected Logger logger = LoggerFactory.getLogger(AuthLink.class);

    protected SimpleDateFormat f = new SimpleDateFormat("yyyy-MM-dd HH:mm:ss");// æ—¶é—´æ ¼å¼åŒ–
    protected String levelUserId;                           // çº§åˆ«äººå‘˜ID
    protected String levelUserName;                         // çº§åˆ«äººå‘˜å§“å
    private AuthLink next;                                  // è´£ä»»é“¾

    public AuthLink(String levelUserId, String levelUserName) {
        this.levelUserId = levelUserId;
        this.levelUserName = levelUserName;
    }

    public AuthLink next() {
        return next;
    }

    public AuthLink appendNext(AuthLink next) {
        this.next = next;
        return this;
    }

    public abstract AuthInfo doAuth(String uId, String orderId, Date authDate);

}

~~~

- è¿™éƒ¨åˆ†æ˜¯è´£ä»»é“¾ï¼Œ**é“¾æ¥èµ·æ¥**çš„æ ¸å¿ƒéƒ¨åˆ†ã€‚`AuthLink next`ï¼Œé‡ç‚¹åœ¨äºå¯ä»¥é€šè¿‡`next`æ–¹å¼è·å–ä¸‹ä¸€ä¸ªé“¾è·¯éœ€è¦å¤„ç†çš„èŠ‚ç‚¹ã€‚
- `levelUserId`ã€`levelUserName`ï¼Œæ˜¯è´£ä»»é“¾ä¸­çš„å…¬ç”¨ä¿¡æ¯ï¼Œæ ‡è®°æ¯ä¸€ä¸ªå®¡æ ¸èŠ‚ç‚¹çš„äººå‘˜ä¿¡æ¯ã€‚
- æŠ½è±¡ç±»ä¸­å®šä¹‰äº†ä¸€ä¸ªæŠ½è±¡æ–¹æ³•ï¼Œ`abstract AuthInfo doAuth`ï¼Œè¿™æ˜¯æ¯ä¸€ä¸ªå®ç°è€…å¿…é¡»å®ç°çš„ç±»ï¼Œä¸åŒçš„å®¡æ ¸çº§åˆ«å¤„ç†ä¸åŒçš„ä¸šåŠ¡ã€‚
- å¯¹åº”å°±æ˜¯è´£ä»»é“¾ä¸­çš„**æŠ½è±¡å¤„ç†è§’è‰²**

 **ä¸‰ä¸ªå®¡æ ¸å®ç°ç±»**

~~~java
public class Level1AuthLink extends AuthLink {

    public Level1AuthLink(String levelUserId, String levelUserName) {
        super(levelUserId, levelUserName);
    }

    public AuthInfo doAuth(String uId, String orderId, Date authDate) {
        Date date = AuthService.queryAuthInfo(levelUserId, orderId);
        if (null == date) {
            return new AuthInfo("0001", "å•å·ï¼š", orderId, " çŠ¶æ€ï¼šå¾…ä¸€çº§å®¡æ‰¹è´Ÿè´£äºº ", levelUserName);
        }
        AuthLink next = super.next();
        if (null == next) {
            return new AuthInfo("0000", "å•å·ï¼š", orderId, " çŠ¶æ€ï¼šä¸€çº§å®¡æ‰¹å®Œæˆè´Ÿè´£äºº", " æ—¶é—´ï¼š", f.format(date), " å®¡æ‰¹äººï¼š", levelUserName);
        }

        return next.doAuth(uId, orderId, authDate);
    }

}

public class Level2AuthLink extends AuthLink {

    private Date beginDate = f.parse("2020-06-11 00:00:00");
    private Date endDate = f.parse("2020-06-20 23:59:59");

    public Level2AuthLink(String levelUserId, String levelUserName) throws ParseException {
        super(levelUserId, levelUserName);
    }

    public AuthInfo doAuth(String uId, String orderId, Date authDate) {
        Date date = AuthService.queryAuthInfo(levelUserId, orderId);
        if (null == date) {
            return new AuthInfo("0001", "å•å·ï¼š", orderId, " çŠ¶æ€ï¼šå¾…äºŒçº§å®¡æ‰¹è´Ÿè´£äºº ", levelUserName);
        }
        AuthLink next = super.next();
        if (null == next) {
            return new AuthInfo("0000", "å•å·ï¼š", orderId, " çŠ¶æ€ï¼šäºŒçº§å®¡æ‰¹å®Œæˆè´Ÿè´£äºº", " æ—¶é—´ï¼š", f.format(date), " å®¡æ‰¹äººï¼š", levelUserName);
        }

        if (authDate.before(beginDate) || authDate.after(endDate)) {
            return new AuthInfo("0000", "å•å·ï¼š", orderId, " çŠ¶æ€ï¼šäºŒçº§å®¡æ‰¹å®Œæˆè´Ÿè´£äºº", " æ—¶é—´ï¼š", f.format(date), " å®¡æ‰¹äººï¼š", levelUserName);
        }

        return next.doAuth(uId, orderId, authDate);
    }

}

public class Level3AuthLink extends AuthLink {

    private Date beginDate = f.parse("2020-06-01 00:00:00");
    private Date endDate = f.parse("2020-06-25 23:59:59");

    public Level3AuthLink(String levelUserId, String levelUserName) throws ParseException {
        super(levelUserId, levelUserName);
    }

    public AuthInfo doAuth(String uId, String orderId, Date authDate) {
        Date date = AuthService.queryAuthInfo(levelUserId, orderId);
        if (null == date) {
            return new AuthInfo("0001", "å•å·ï¼š", orderId, " çŠ¶æ€ï¼šå¾…ä¸‰çº§å®¡æ‰¹è´Ÿè´£äºº ", levelUserName);
        }
        AuthLink next = super.next();
        if (null == next) {
            return new AuthInfo("0000", "å•å·ï¼š", orderId, " çŠ¶æ€ï¼šä¸‰çº§å®¡æ‰¹è´Ÿè´£äººå®Œæˆ", " æ—¶é—´ï¼š", f.format(date), " å®¡æ‰¹äººï¼š", levelUserName);
        }

        if (authDate.before(beginDate) || authDate.after(endDate)) {
            return new AuthInfo("0000", "å•å·ï¼š", orderId, " çŠ¶æ€ï¼šä¸‰çº§å®¡æ‰¹è´Ÿè´£äººå®Œæˆ", " æ—¶é—´ï¼š", f.format(date), " å®¡æ‰¹äººï¼š", levelUserName);
        }

        return next.doAuth(uId, orderId, authDate);
    }

}

~~~

- å¦‚ä¸Šä¸‰ä¸ªç±»ï¼›`Level1AuthLink`ã€`Level2AuthLink`ã€`Level3AuthLink`ï¼Œå®ç°äº†ä¸åŒçš„å®¡æ ¸çº§åˆ«å¤„ç†çš„ç®€å•é€»è¾‘ã€‚
  - **å¯¹åº”å…·ä½“å¤„ç†è€…è§’è‰²**
- ä¾‹å¦‚ç¬¬ä¸€ä¸ªå®¡æ ¸ç±»ä¸­ä¼šå…ˆåˆ¤æ–­æ˜¯å¦å®¡æ ¸é€šè¿‡ï¼Œå¦‚æœæ²¡æœ‰å®¡æ ¸é€šè¿‡åˆ™è¿”å›ç»“æœç»™è°ƒç”¨æ–¹ï¼Œå¼•å¯¼å»å®¡æ ¸ã€‚*ï¼ˆè¿™é‡Œç®€å•æ¨¡æ‹Ÿå®¡æ ¸åæœ‰æ—¶é—´ä¿¡æ¯ä¸ä¸ºç©ºï¼Œä½œä¸ºåˆ¤æ–­æ¡ä»¶ï¼‰*
- åˆ¤æ–­å®Œæˆåè·å–ä¸‹ä¸€ä¸ªå®¡æ ¸èŠ‚ç‚¹ï¼›`super.next();`ï¼Œå¦‚æœä¸å­˜åœ¨ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥è¿”å›ç»“æœã€‚
- ä¹‹åæ˜¯æ ¹æ®ä¸åŒçš„ä¸šåŠ¡æ—¶é—´æ®µè¿›è¡Œåˆ¤æ–­æ˜¯å¦éœ€è¦ï¼ŒäºŒçº§å’Œä¸€çº§çš„å®¡æ ¸ã€‚æœ€åè¿”å›ä¸‹ä¸€ä¸ªå®¡æ ¸ç»“æœï¼›`next.doAuth(uId, orderId, authDate);`ï¼Œæœ‰ç‚¹åƒé€’å½’è°ƒç”¨ã€‚

###  æµ‹è¯•

è´£ä»»é“¾æ¨¡å¼çš„è°ƒç”¨ç±»ä¼¼è¿™æ ·

~~~java
@Test
public void test_AuthLink() throws ParseException {
    AuthLink authLink = new Level3AuthLink("1000013", "ç‹å·¥")
            .appendNext(new Level2AuthLink("1000012", "å¼ ç»ç†")
                    .appendNext(new Level1AuthLink("1000011", "æ®µæ€»")));
}
~~~

- è¿™é‡ŒåŒ…æ‹¬æœ€æ ¸å¿ƒçš„è´£ä»»é“¾åˆ›å»ºï¼Œå®é™…çš„ä¸šåŠ¡ä¸­ä¼šåŒ…è£…åˆ°æ§åˆ¶å±‚ï¼›`AuthLink authLink = new Level3AuthLink("1000013", "ç‹å·¥") .appendNext(new Level2AuthLink("1000012", "å¼ ç»ç†") .appendNext(new Level1AuthLink("1000011", "æ®µæ€»")));` é€šè¿‡æŠŠä¸åŒçš„è´£ä»»èŠ‚ç‚¹è¿›è¡Œç»„è£…ï¼Œæ„æˆä¸€æ¡å®Œæ•´ä¸šåŠ¡çš„è´£ä»»é“¾ã€‚

