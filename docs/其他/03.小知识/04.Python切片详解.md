---
title: Python切片详解
date: 2023-03-17 00:00:00
tags: 
  - null
categories: 
  - 其他
  - 小知识
permalink: /pages/7c6019/
---

> 参考：https://zhuanlan.zhihu.com/p/79541418
>
>https://www.jb51.net/article/208106.htm

# 切片介绍

在Python中，**切片(slice)**是对序列型对象(如`list`, `string`, `tuple`)的一种高级索引方法。普通索引只取出序列中**一个下标**对应的元素，而切片取出序列中**一个范围**对应的元素，这里的范围不是狭义上的连续片段

## 1 .一维数组切片

### **基本索引**

我们从Python的基本索引开始，即**单个整数**的索引。假设被索引的序列仍为之前提到的`a`，则基本索引的语法为`a[index]`，其中`index`为下标。读者可能会觉得这里过于简单，但我们要强调的是Python一个语法糖：**负数下标**索引，即：`index`可以取为负数，当其为`-n`时，对倒数第`n`个元素进行索引。我们用一张表格值观展示`a`的索引范围。

![img](https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/v2-ecb0b9ef110c07e9bfb31bf496396e7b_720w.webp)

非负下标索引和负数下标索引共同构成了Python索引的**有效范围**：。有效范围的概念对切片的理解非常重要，在基本索引中，索引超出有效范围时会抛出`IndexError`异常：

~~~python
 >>> a
 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
 >>> a[10]
 Traceback (most recent call last):
   File "<stdin>", line 1, in <module>
 IndexError: list index out of range
 >>> a[-11]
 Traceback (most recent call last):
   File "<stdin>", line 1, in <module>
 IndexError: list index out of range
~~~

### 切片

简单切片指的是这样的切片形式：`a[start:stop]`，其行为是得到下标在这样一个**前闭后开区间**范围内的元素，其中`start`和`stop`为负数时，简单看作是负数下标对应的位置即可：

~~~python
 >>> a
 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
 >>> a[2:3]
 [2]
 >>> a[5:9]
 [5, 6, 7, 8]
 >>> a[5:-1]
 [5, 6, 7, 8]
 >>> a[-5:9]
 [5, 6, 7, 8]
 >>> a[-5:-1]
 [5, 6, 7, 8]
~~~

### 特殊情况

#### **超出有效索引范围**

当`start`或`stop`超出上文提到的有效索引范围时，**切片操作不会抛出异常，而是进行截断**。可以这样去理解截断机制：我们把索引范围**扩充**到全体整数，只不过小于或大于的区域对应**空元素**，在这个扩充后的数轴上进行切片，只需把最终结果中的所有空元素忽略即可。

来看几个具体的例子

```python
 >>> a
 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
 >>> a[-100:5]
 [0, 1, 2, 3, 4]
 >>> a[5:100]
 [5, 6, 7, 8, 9]
 >>> a[-100:100]
 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
 >>> a[100:1000]
 []
```

另外，如果`start`的位置比`stop`还靠后怎么办？Python还是不会抛出异常，而是直接返回空序列：

```python
 >>> a
 [0, 1, 2, 3, 4, 5, 6, 7, 8, 9]
 >>> a[6:5]
 []
```

#### **缺省**

`start`和`stop`都是可以缺省的，在缺省的情况下，Python的行为是**尽可能取最大区间**，具体来说：

> ！！！按照扩充索引范围的观点，`start`的缺省值是**无穷小()**，`stop`的缺省值是**无穷大()**。

**因此[:-1]和[:]结果不一样（**当然这有左闭右开的影响）

### 加入步长

`a[start:stop:step]`，其中`step`是一个非零整数，即比简单切片多了调整**步长**的功能，此时切片的行为可概括为：从`start`对应的位置出发，以`step`为步长索引序列，直至越过`stop`对应的位置，且不包括`stop`本身。**也就是左闭右开。**

- 如果step缺省，那么step=1
- 如果step>0,那么表示从start 到end，以步长为1的方式进行截断
- 如果step<0，那么表示从end到start

## 2.多维数组切片

### python中的多维数组

可以使用numpy创建多维数组

~~~shell
>>> a = np.arange(24).reshape(2,3,4)
>>> a
array([[[ 0,  1,  2,  3],
        [ 4,  5,  6,  7],
        [ 8,  9, 10, 11]],
       [[12, 13, 14, 15],
        [16, 17, 18, 19],
        [20, 21, 22, 23]]])
>>> a = np.arange(6).reshape(2,3)
>>> a
array([[0, 1, 2],
       [3, 4, 5]])
~~~

这里解释一下reshape()的含义

reshape(3,4)表示一个二维数组，有三行四列

reshape(2,3,4)表示一个三维数组，有2高三行四列

reshape(2,3,4,5)表示一个四维数组，有两个第四维的数组分别包含了三高四行五列的数组

**所以，其实python中，多维数组就是这样一层层包起来的**

### 如何切片？

对于不同维度的数据，**使用逗号隔开**，隔开的切片对应那个数组

以二维数组为例

~~~python
>>> a = np.arange(12).reshape(3,4)
>>> a
array([[ 0,  1,  2,  3],
       [ 4,  5,  6,  7],
       [ 8,  9, 10, 11]])
>>> x=a[:,:-1]
>>> x
array([[ 0,  1,  2],
       [ 4,  5,  6],
       [ 8,  9, 10]])
>>>
~~~

**解释：**

a[:,:-1]这样来分析，“:”表示该维度数组取全部，故结果仍然是三行，":-1"表示取该维度除最后一个外的元素，该维度表示列，故只有3列了。

