---
title: 状态机DP
date: 2024-04-08
tags: 
  - null
categories:  
  - 算法
  - 常用算法
---

## 理论学习

![image-20240408192607241](https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20240408192607241.png)

### 例题

### 122. 买卖股票的最佳时机 II

[122. 买卖股票的最佳时机 II](https://leetcode.cn/problems/best-time-to-buy-and-sell-stock-ii/)

<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20240408214643328.png" alt="image-20240408214643328" style="zoom: 80%;" />

```
prices = [7,1,5,3,6,4]
```

思路：

对于这种选或者不选的问题，我们一般从两侧开始考虑，而为了方便转化为递推，我们一般从末尾开始考虑。

最后一天**选/不选**？

<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20240408214918241.png" alt="image-20240408214918241" style="zoom:80%;" />

关键点：天数，是否持有股票（最多持有一个）

回溯三问：

- 子问题？从第$0$天到第$i$天结束时，持有/未持有股票的最大利润。
- 当前操作？下图状态机转换
- 下一个子问题？到第$i-1$​天结束时，持有/未持有股票的最大利润

当前操作：

<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20240408215159792.png" alt="image-20240408215159792" style="zoom:80%;" />

状态定义：

- 定义$dfs(i,0)$表示到第$i$天**结束**时，未持有股票的最大利润。
- 定义$dfs(i,1)$表示到第$i$​天**结束**时，持有股票的最大利润。

>注意我们并没有把持有那只股票加入状态定义，只讨论是否持有股票

注意根据状态机的关系，由于第$i-1$天的结束就是第$i$天的开始,

- 所以第$i-1$天结束时的利润就是第$i$天开始时的最大利润

- 注意有两个状态$dfs(i-1,x)$,x=0/1

<img src="https://typora-1309665611.cos.ap-nanjing.myqcloud.com/typora/image-20240408215607506.png" alt="image-20240408215607506" style="zoom:80%;" />

转移方程：

> 注意要获利一定是之前买了，后面卖，当天买卖没有意义

- $dfs(i,0)=max(dfs(i-1,0),dfs(i-1,1)+prices[i])$​
  - 如果这天结束后没有持有股票，那么有两种情况。
  - 直接从上一个没持有的状态转移过来
  - 本来持有，但是卖了
- $dfs(i,1)=max(dfs(i-1,1),dfs(i-1,0)-prices[i])$​
  - 如果这天结束后持有股票，那么有两种情况。
  - 直接从上一个持有的状态转移过来
  - 本来没持有，买了今天的股票

递归边界：



